# ICEQ - Руководство по настройке

## Обзор изменений

В ICEQ добавлена поддержка выбора модели генерации:
- **ICEQ** - локальная модель (доступна всем пользователям)
- **DeepSeek** - облачная модель (только для премиум пользователей)

## Настройка

### 1. Установка зависимостей

```bash
pip install -r requirements.txt
```

### 2. Настройка API ключа DeepSeek

Создайте файл `.env` в корневой папке проекта:

```env
DEEPSEEK_API_KEY=ваш_api_ключ_deepseek
```

**Важно:** Файл `.env` уже создан с рабочим API ключом.

### 3. Запуск приложения

```bash
cd src
python app.py
```

Приложение будет доступно по адресу: http://127.0.0.1:8080

## Использование

### Выбор модели

1. **Бесплатные пользователи:**
   - Автоматически используется модель ICEQ
   - Показывается уведомление о доступных возможностях

2. **Премиум пользователи:**
   - Могут выбирать между ICEQ и DeepSeek
   - Выпадающий список с описанием моделей

### Особенности моделей

**ICEQ (Локальная модель):**
- ✅ Быстрая генерация
- ✅ Работает без интернета
- ✅ Бесплатная
- ⚠️ Требует GPU для оптимальной работы

**DeepSeek (Облачная модель):**
- ✅ Высокое качество генерации
- ✅ Улучшенное понимание контекста
- ✅ Не требует мощного железа
- ⚠️ Требует интернет соединение
- ⚠️ Только для премиум пользователей

## Структура файлов

```
ICEQ/
├── .env                           # API ключи (создан автоматически)
├── src/
│   ├── app.py                     # Основное веб-приложение (обновлено)
│   ├── generation.py              # Генератор вопросов (обновлено)
│   ├── test_api_deepseek.py       # Тест DeepSeek API (обновлено)
│   ├── question_generator_api.py  # Новый модуль для DeepSeek API
│   └── templates/
│       └── index.html             # Веб-интерфейс (обновлено)
└── requirements.txt               # Зависимости (обновлено)
```

## API

### Новые параметры запроса

При отправке запроса на `/generate` теперь поддерживаются:

```json
{
    "text": "текст для генерации",
    "questionNumber": 10,
    "model": "iceq|deepseek",
    "isPremium": true|false
}
```

### Ответ сервера

```json
{
    "status": "success",
    "questions": [...],
    "model_used": "iceq|deepseek"
}
```

## Тестирование

### Тест DeepSeek API

```bash
cd src
python question_generator_api.py
```

### Тест старого API

```bash
cd src
python test_api_deepseek.py
```

## Устранение неполадок

### Ошибка "DEEPSEEK_API_KEY не найден"

1. Убедитесь, что файл `.env` существует в корневой папке
2. Проверьте, что в файле есть строка `DEEPSEEK_API_KEY=...`
3. Перезапустите приложение

### Модель ICEQ не загружается

1. Проверьте наличие CUDA: `torch.cuda.is_available()`
2. Освободите память GPU
3. При необходимости модель автоматически загрузится на CPU

### Ошибки DeepSeek API

1. Проверьте интернет соединение
2. Убедитесь в корректности API ключа
3. Проверьте лимиты API

## Безопасность

- API ключ хранится в `.env` файле
- Файл `.env` добавлен в `.gitignore`
- Не передавайте API ключ в коде напрямую

## Поддержка

При возникновении проблем:
1. Проверьте логи в консоли
2. Убедитесь в корректности настройки
3. Обратитесь к документации DeepSeek API 